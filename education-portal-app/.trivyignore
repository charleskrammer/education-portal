# .trivyignore — Explicit allowlist for accepted Trivy findings.
# Format: CVE-YYYY-NNNNN  # justification
#
# Each entry MUST include a justification comment explaining:
#   - Why the finding is accepted (false positive, not exploitable, etc.)
#   - The date the decision was reviewed
#   - The planned remediation date (if applicable)
#
# Example (remove the '#' to activate):
# CVE-2023-12345  # Not exploitable: package used only in build stage, not shipped in runtime image. Reviewed 2026-02-24.
#
# To regenerate the candidate list:
#   trivy fs --scanners vuln,secret,misconfig --severity HIGH,CRITICAL .
#   trivy image --severity HIGH,CRITICAL claude-training-portal:ci

# Next.js HTTP request deserialization can lead to DoS when using insecure React.
# No fix available in Next.js 14.x branch; only patched in 15.0.8+.
# Remediation: upgrade to Next.js 15 when stable compatibility is confirmed.
# Reviewed 2026-02-24.
GHSA-h25m-26qc-wcjf

# The following vulnerabilities are in npm's own bundled packages
# (/usr/local/lib/node_modules/npm/node_modules/ in the node:20-bookworm-slim base image).
# They are NOT from the application's node_modules. The application's copies of these
# packages are dev-only (pruned via `npm prune --omit=dev`) and are absent at runtime.
# npm itself is never invoked in the production container — only the Next.js server runs.
# Remediation: update the base node image when npm ships fixed internal versions.
# Reviewed 2026-02-24.

# cross-spawn ReDoS in npm internals (npm bundles cross-spawn@7.0.3; app uses 7.0.6 dev-only)
CVE-2024-21538

# glob command injection via malicious filenames in npm internals (app glob is dev-only, pruned)
CVE-2025-64756

# minimatch ReDoS in npm internals (app minimatch is dev-only, pruned; never processes user input)
CVE-2026-26996

# tar arbitrary file overwrite via unsanitized linkpaths in npm internals (not in app lockfile)
CVE-2026-23745

# tar arbitrary file overwrite via Unicode path collision in npm internals (not in app lockfile)
CVE-2026-23950

# tar arbitrary file creation via path traversal bypass in npm internals (not in app lockfile)
CVE-2026-24842

# tar arbitrary file read/write via malicious archive hardlink in npm internals (not in app lockfile)
CVE-2026-26960
